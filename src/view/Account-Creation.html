<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account Creation</title>
    
    <!-- Link to the relevant files -->
    <script src='src/SpotFront.js'></script>
    <link rel='stylesheet' type = 'text/css' href='css/Generals.css'>
    <link rel='stylesheet' type = 'text/css' href='css/Assets.css'>
</head>
<body>
    <header>
        
        <!-- This button will take the user back to the home page,Should eventually contain logo -->
        <a href = "index.html">
            <button class = "homeButton" class = "generalText">Home</button>
        </a>
        <div class = "pageTitle">
        <h1 class = "generalText">Account Creation</h1>
        </div>

    <!--basic form for account creation frontend, not linked to any logic yet-->
        <div class="account-box">
            <form id="accountForm">
                <div class="form-group">
                    <label for="fullName" class="generalText">Full Name</label>
                    <input type="text" id="fullName" name="fullName" required>
                </div>
                
                <div class="form-group">
                    <label for="email" class="generalText">Email Address</label>
                    <input type="email" id="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label for="username" class="generalText">Username</label>
                    <input type="text" id="username" name="username" required>
                </div>
                
                <div class="form-group">
                    <label for="password" class="generalText">Password</label>
                    <input type="password" id="password" name="password" required>
                </div>
                
                <div class="form-group">
                    <label for="confirmPassword" class="generalText">Confirm Password</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" required>
                </div>
                
                <button type="submit" class="submit-button generalText">Create Account</button>
                
                <div class="form-footer generalText">
                    <p>Already have an account? <a href="login.html">Log In</a></p>
                </div>
            </form>
        </div>
    </header>
    <script>
        //
        document.addEventListener('DOMContentLoaded', function() {
          const accountForm = document.getElementById('accountForm');
          
          accountForm.addEventListener('submit', async function(event) {
            event.preventDefault();
            
            // Get form values
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const fullName = document.getElementById('fullName').value;
            const email = document.getElementById('email').value;
            
            // Simple validation
            if (password !== confirmPassword) {
              alert('Passwords do not match!');
              return;
            }
            
            // Create request data
            const userData = {
              username,
              password,
              fullName,
              email
            };
            
            try {
              // Send data to server
              const response = await fetch('/api/create-account', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                },
                body: JSON.stringify(userData)
              });
              
              const result = await response.json();
              
              if (result.success) {
                alert('Account created successfully!\nLook at console for username and hashed password\nSCRUM-40');
                window.location.href = '/login';
              } else {
                alert('Error creating account: ' + result.message);
              }
            } catch (error) {
              console.error('Error:', error);
              alert('An error occurred while creating your account.');
            }
          });
        });
      </script>
</body>
</html>